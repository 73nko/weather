import type {NextPage} from 'next';
import Head from 'next/head';
import { Header } from '../components/Header';
import { Typography } from 'antd';

import { Button, DatePicker, Form, Input, Space, version, Row } from 'antd';
import { mainModule } from 'process';
import { useState } from 'react';

const { Title } = Typography;


const Home: NextPage = () =>{
  const [city, setCity] = useState("")
  const [temperature,setTemperature] = useState(0)
  const [maxTemp,setMaxTemp] = useState(0)
  const [minTemp,setMinTemp] = useState(0)

  
// let city: string = "murcia".toUpperCase()

const callApi = () => {
  fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&appid=7c6a959f5ad058e3e406fb96bc4acfdc`)
    .then(res => res.json())
    .then(data => { 
      const temperature = data.main.temp
      const maxTemp = data.main.temp_max
      const minTemp = data.main.temp_min
      setTemperature(temperature)
      setMaxTemp(maxTemp)
      setMinTemp(minTemp)
    })
}

const handleCity = (event: any) => {
  setCity(event.target.value)
}


  return (
    <>
      <Head>
        <title>Weather APP</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Header>{"What's the Weather"}</Header>
      <Title level={2} style={{color: "white"}}>Select a date to see the weather</Title>
      <Space direction="vertical" size="middle" style={{ display: 'flex' }}>
        <Space>
          <DatePicker />
          <Button type="primary" style={{ marginLeft: 8 }}>
            Date
          </Button>
        </Space>
        <Space>
          <Form layout='horizontal'>
            <Space>
              <Space direction='vertical'>
                <Title level={2} style={{color: "white"}}>Select a City</Title>
                <Form.Item style={{color: 'white'}}>
                  <Input placeholder='Search a City' style={{ width: 300}} onChange={handleCity}/>
                  <Button type='primary' style={{ marginLeft: 8 }} onClick={callApi}>Search</Button>
                </Form.Item>
              </Space>
            </Space>
          </Form>
        </Space>
      </Space>
          <h2 style={{color: 'white'}}>{city.toUpperCase()}</h2>
          <p>La temperatura actual en {city} es: {temperature}</p>
          <p>La temperatura maxima actual en {city} es: {maxTemp}</p>
          <p>La temperatura minima actual en {city} es: {minTemp}</p>
    </>
  );
};

export default Home;

